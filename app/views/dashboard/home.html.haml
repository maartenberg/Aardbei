.container
  .row
    - if @need_response.any?
      .col-md-12
        .panel.panel-default
          .panel-heading
            Need response

          .panel-body
            %table.table.table-bordered
              %thead
                %tr
                  %th
                    Name
                  %th
                    Group
                  %th
                    When
                  %th
                    Where
                  %th
                    Actions

              %tbody
                - @need_response.each do |p|
                  - e = p.activity
                  %tr{class: p.row_class, data: {activity_id: e.id, person_id: current_person.id}}
                    %td
                      = e.public_name
                      - if e.secret_name && e.participants.first.is_organizer
                        %i
                          = "(#{e.secret_name})"
                    %td
                      = e.group.name
                    %td
                      = e.start
                    %td
                      = e.location
                    %td
                      = render partial: "activities/presence_buttons", locals: {activity: e, person: current_person, state: p.attending}
  .row
    .col-md-6
      .panel.panel-default
        .panel-heading
          Groups

        .panel-body
          %table.table.table-bordered
            %tbody
              - current_person.groups.each do |group|
                %tr
                  %td
                    = link_to group do
                      = group.name

    .col-md-6
      .panel.panel-default
        .panel-heading
          Organized by you

        .panel-body
          %table.table.table-striped.table-bordered
            %tbody
              - @user_organized.each do |p|
                - a = p.activity
                %tr
                  %td
                    = link_to group_activity_url(a.group, a) do
                      = "#{a.public_name} (#{a.secret_name})"

  .row
    .col-md-12
      .panel.panel-default
        .panel-heading
          Your activities

        .panel-body
          %table.table.table-striped
            %tbody
              - @upcoming.each do |p|
                - e = p.activity
                %tr{class: p.row_class, data: {activity_id: e.id, person_id: current_person.id}}
                  %td
                    = e.public_name
                  %td
                    = render partial: "activities/presence_buttons", locals: {activity: e, person: current_person, state: p.attending}
                  %td
                    = editable p, :notes, url: presence_group_activity_path(e.group, e, person_id: current_person.id), title: "Notes", value: p.notes, emptytext: 'Notes'
